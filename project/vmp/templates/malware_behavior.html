{% extends 'base.html' %}
{% load static %}

{% block body %}
    <style>
    li#a{
        font-size:20px;
        margin-right: auto;
        padding:6px 12px 6px 60px;
        text-indent: 25px
    }

    ul#a{
        font-size:20px;
        margin-right: auto;
        padding:6px 12px 6px 60px;

    }
    dl#a{
        font-size:30px;
        margin-right: auto;
        padding:6px 12px 6px 60px;

    }

    p#a{font-size: 20px;text-align:left;}

    span#intra1{
         color:#A326FF; }

    span#intra2{
         color:#00CCCC; }
    table,th,td#Ta{
        border:1px solid;
        border-collapse:collapse;
    }

    </style>

<div class="container-fluid malware_info">
    <ul class="nav nav-tabs">
        <li >
            <a class="active" data-toggle="tab" href="#home"><b>Characteristic Behavior Analysis: Intra-Family (1/3)</b></a></li>
        <li>
            <a data-toggle="tab" href="#menu2"><b>Intra-Family(2/3)</b></a>
        </li>
        <li>
            <a data-toggle="tab" href="#menu3"><b>Intra-Family(3/3)</b></a>
        </li>
        <li>
            <a data-toggle="tab" href="#menu4"><b>The Power of Incorporating Runtime Parameters and Return Values in Behavior Analysis</b></a>
        </li>
        <li>
            <a data-toggle="tab" href="#menu5"><b>Behavior Analysis: Inter-family Behavior Classification</b></a>
        </li>
        <li>
            <a data-toggle="tab" href="#menu6"><b>Behavior Classification</b></a>
        </li>
    </ul>

    <div class="tab-content">
        <div id="menu5" class="tab-pane fade in active">
            <div class="panel-body" style="background-color: #F2EEDF;">
                <h2 style="text-indent: 20px;"><b>Behavior Analysis: Inter-family Behavior Classification</b></h2>
                <dl id="a">
{#                    <tr>#}
{#                        <td><h3><b>Install subsequent malware</b></h3></td>#}
{#                        <td><h3><b>Install toolbars</b></h3></td>#}
{#                    </tr>#}

                        <dt><i class="fa fa-dot-circle-o" aria-hidden="true"></i>&nbsp;<b>Phylogenetic tree analysis:</b></dt>
                            <dd><i class="fa fa-circle" aria-hidden="true"></i>&nbsp;16 distinct behavior groups and their characteristic behaviors</dd>
                            <dd><i class="fa fa-circle" aria-hidden="true"></i>&nbsp;Common behavior motifs between groups; Unique motif(s) of a group</dd>
                            <dd><i class="fa fa-circle" aria-hidden="true"></i>&nbsp;Significant behavior motifs that differentiate groups.</dd>
                         <br><br>

                         <dt><i class="fa fa-dot-circle-o" aria-hidden="true"></i>&nbsp;<b>Performance evaluation:</b></dt>
                            <dd><i class="fa fa-circle" aria-hidden="true"></i>&nbsp;Given a data set with 419 malware processes (277 for training and 42 for testingï¼›performing 10-fold classification test)</dd>
{#                            <i class="fa fa-dot-circle-o" aria-hidden="true"></i>&nbsp;<b>False Negative: 1.9%</b>#}
                            <br><br><br>

                            <dt style="color: darkred; text-align: start "><i class="fa fa-dot-circle-o" aria-hidden="true" ></i>&nbsp;<b>False Negative: 1.9%</b></dt>
                            <dd style="font-size: 20px; color: gray; display: inline; text-align: center;">(Click to enlarge)</dd>
                            <div id="image-gallery-1" class="cf" style="padding-top: 10px; text-align: center;" >
                    <img src="{% static 'image/behavior1.jpg' %}" data-high-res-src="{% static 'image/featureProfile.JPG' %}" alt="" class="profile-picture" width="500" height="800">
                            </div>

                </dl>
            </div>

    </div>

       <div id="home" class="tab-pane fade">
            <div class="panel-body" style="background: #F2EEDF !important;">
                <h2 ><b>Characteristic Behavior Analysis: Intra-Family (1/3)</b></h2>
                <div class="illustration">
{#                    <p style="font-size: 29px "><i class="fa fa-bullseye" aria-hidden="true"></i>&nbsp; Characteristic Behavior Analysis: Intra-Family (1/3)</p>#}
                     <img src="{% static 'image/Intra Family 1.jpg' %}" style="width: 800px;">
                </div>
                <ul>
{#                <p style="font-size: 29px; color: gray; display: inline;">Jaccard Distance and Unweighted Pair Group Method with Arithmetic Mean (UPGMA) are adopted to construct the phylogenetic tree.</p>#}
                    <li id=a style="font-size: 26px; "> Jaccard Distance and Unweighted Pair Group Method with Arithmetic Mean (UPGMA) are adopted to construct the <span id="intra1"> phylogenetic tree.</span></li>
                    <li id=a style="font-size: 26px"> Each group has its <span id="intra1">unique</span> behavior, which is ascertained by <span id="intra1">a collection of API calls</span>.</li>
                </ul>
                    <div id="image-gallery-1" class="cf" style="padding-top: 10px;">
                </div>
{#                <iframe src="{% static 'image/output.pdf' %}" style="width: 100%; height: 1500px;"></iframe>#}
            </div>
        </div>
{#        <div id="menu2" class="tab-pane fade">#}
{#            <div class="panel-body" style="background: #F2EEDF !important;">#}
{#                <h2 class="text-center"><b>Malware Family: Firseria</b></h2>#}
{#                <div class="illustration">#}
{#                    <p><i class="fa fa-bullseye" aria-hidden="true"></i>&nbsp; Legend</p>#}
{#                    <img src="{% static 'image/1.PNG' %}" style="height: 225px;width: 665px;">#}
{#                </div>#}
{#                <div id="image-gallery-1" class="cf" style="padding-top: 10px;">#}
{#                    <img src="{% static 'image/output2.jpg' %}" data-high-res-src="{% static 'image/output2.jpg' %}" alt="" class="gallery-items">#}
{#                </div>#}
{#                <iframe src="{% static 'image/output.pdf' %}" style="width: 100%; height: 1500px;"></iframe>#}
{#            </div>#}
{#        </div>#}


        <div id="menu2" class="tab-pane fade">
            <div class="panel-body" style="background-color: #F2EEDF;">
                <div class="" style=" padding: 10px; margin-bottom: 10px;">
                    <h2><b>Characteristic Behavior Analysis: Intra-Family (2/3)</b></h2>
                     <p style="padding 5px 5px 5px 30px"><img src="{% static 'image/Intra Family 2.jpg' %}" style="width: 677px;">
                </div>

                <p style="text-indent: 25px; color:	#00A300; font-weight:bold"><i class="fa fa-dot-circle-o" aria-hidden="true"></i>&nbsp;G1- Hijack homepage</p>
                <ul>
                       <ul id=a ><i class="fa fa-circle" aria-hidden="true"></i>&nbsp;launch a File Explorer;</ul>
                       <ul id=a ><i class="fa fa-circle" aria-hidden="true"></i>&nbsp;remove browsing records;</ul>
                       <ul id=a ><i class="fa fa-circle" aria-hidden="true"></i>&nbsp;change some Internet settings;</ul>
                       <ul id=a ><i class="fa fa-circle" aria-hidden="true"></i>&nbsp;ses up an auto-execution file in the system drive.</ul>
                </ul>
                <p style="text-indent: 25px; color:#C70000; font-weight:bold"><i class="fa fa-dot-circle-o" aria-hidden="true"></i>&nbsp;G2- Install malware as a system daemon</p>
                <ul>
                    <ul id=a ><i class="fa fa-circle" aria-hidden="true"></i>&nbsp;check the system services in the host; </ul>
                    <ul id=a ><i class="fa fa-circle" aria-hidden="true"></i>&nbsp;make a copy of the malware binary; </ul>
                    <ul id=a ><i class="fa fa-circle" aria-hidden="true"></i>&nbsp;execute the malware binary. </ul>
                </ul>

                <p style="text-indent: 25px; color:#00CCCC; font-weight:bold"><i class="fa fa-dot-circle-o" aria-hidden="true"></i>&nbsp;G3</p>
                <ul>
                    <ul id=a ><i class="fa fa-circle" aria-hidden="true"></i>&nbsp;Similar to G2 which might <span id="intra1">correspond to unsuccessful attacks</span>. (non-existent IP addr, time-triggered action, long incubation time, etc.) </ul>

                </ul>
            </div>
        </div>


        <div id="menu3" class="tab-pane fade">
            <div class="panel-body"style="background: #F2EEDF !important;">
                <h2><b>Characteristic Behavior Analysis: Intra-Family (3/3)</b></h2>
                <p style="padding 5px 5px 5px 30px"><img src="{% static 'image/Intra Family3.png' %}" width="800" height="350">
                    </p>

    <style>
    table,th,td{
        border:1px solid;
        border-collapse:collapse;
    }
    th, td{
        padding:5px;
        text-align: left;
        font-size: 25px;
    }
    tr:nth-child(even){
        background-color: lightskyblue;
    }
    tr:nth-child(odd){
        background-color: #0e90d2;
    }
    th{
        color: whitesmoke;
        text-align: center;
    }

    </style>
                <br><br>
                <table >
                <tr>
                    <th>Group</th>
                    <th>#Of Processes</th>
                    <th>Differentiated APIs</th>
                    <th>Example Characteristics</th>
                    <th>Semantics</th>
                </tr>
                <tr>
                    <td>G1</td>
                    <td>14</td>
                    <td>490(610)</td>
                    <td>RegCreateKey: P3Sites;<br>RegSetValue: Shell Folders;<br>RegSetValue: ProxyEnable;<br>RegCreateKey:CmdMapping;</td>
                    <td>// change IE security Setting<br>// change system folder location<br>// disable HTTP proxy<br>// change the appearance of IE toolbar</td>
                </tr>
                 <tr>
                    <td>G2</td>
                    <td>14</td>
                    <td>184(304)</td>
                    <td>CreateProcessInternal;<br>RegCreateKey:Explore;<br>LoadLibrary: netapi32;<br>RegCreateKey:Blocked;</td>
                    <td> // create a new process from TMP folder<br>// change Explorer setting<br>// load a specific library<br>// block shell extensions in Windows</td>
                </tr>
                 <tr>
                    <td>G3</td>
                    <td>2</td>
                    <td></td>
                    <td></td>
                    <td></td>
                 </tr>
                </table>


{#                <div class="illustration">#}
{#                    <p><i class="fa fa-bullseye" aria-hidden="true"></i>&nbsp; Legend</p>#}
{#                    <img src="{% static 'image/2.PNG' %}" style="width: 350px;">#}
{#                </div>#}
{##}
{#                <div class="plot">#}
{#                    <p style="display: inline;"><i class="fa fa-bullseye" aria-hidden="true"></i>&nbsp; Family Stage Sequence </p>#}
{#                    <p style="font-size: 14px; color: gray; display: inline;">(Click to enlarge)</p>#}
{#                    <div id="image-gallery-1" class="cf" style="padding-top: 10px;">#}
{#                        <img src="{% static 'image/featureProfile.JPG' %}" data-high-res-src="{% static 'image/featureProfile.JPG' %}" alt="" class="gallery-items">#}
{#                    </div>#}
{#                </div>#}
{##}
{#                <div class="illustration">#}
{#                    <p ><i class="fa fa-bullseye" aria-hidden="true"></i>&nbsp; Summary of API usage statistic of common motifs</p>#}
{#                    <img class="text-center" src="{% static 'image/5.PNG' %}" style="width: 600px;">#}
{#                </div>#}
            </div>
        </div>

        <div id="menu6" class="tab-pane fade">
            <div class="panel-body" style="background-color: #F2EEDF;">
                <div class="" style=" padding: 10px; margin-bottom: 10px;">
                    <h2><b>How good is our behavior classification?</b></h2>
                    <p style="padding 5px 5px 5px 5px"><img src="{% static 'image/page6.png' %}" style="width: 1300px;">
                    <p style="text-indent: 11px; font-size:30px;"><i class="fa fa-dot-circle-o" aria-hidden="true"></i>     We propose a scoring method, Pairwise Classification Score (PSC)</p>
                    <p style="text-indent: 11px; font-size:30px;"><i class="fa fa-dot-circle-o" aria-hidden="true"></i>     Use VirtusTotal (56) antivirus engines and our malware classification engine (1) to evaluate the disapproval probability of engine x from y.</p>
                    <p style="text-indent: 25px; font-size:25px;">     - For a pair of malware samples, i and j, voting mechanism: yes (n) vs. no (57-n); an engine receives n if its result is in the yes group.</p>
                </div>
                </div>
        </div>


            <div id="menu4" class="tab-pane fade">
            <div class="panel-body" style="background-color: #F2EEDF;">
                <div class="" style=" padding: 10px; margin-bottom: 10px;">
                    <h2><b>The Power of Incorporating Runtime Parameters and Return Values in Behavior Analysis</b></h2>
                    <p style="padding 5px 5px 5px 5px"><img src="{% static 'image/page4.png' %}" style="width: 1300px;">
                    <p style="padding 5px 0px 20px 0px; ">
                    <p style="text-indent: 45px; font-size:40px;"><i class="fa fa-dot-circle-o" aria-hidden="true"></i>     N-gram: computation complexity, issue of over-fitting.</p>

                </div>
                </div>
{#<div id="menu4" class="tab-pane fade">#}
{#           <div class="panel-body"style="background: #F2EEDF !important;">#}
{#                <h2><b>The Power of Incorporating Runtime Parameters and Return Values in Behavior Analysis</b></h2>#}

                    </div>
                </div>

{#        <div id="menu4" class="tab-pane fade">#}
{#            <div class="container-fluid" style="background-color: #F2EEDF;">#}
{#                <h2 ><b>Malware Family: Firseria</b></h2>#}
{#                <div class="row">#}
{#                    <nav class="col-sm-2" style="padding: 20px 0px 20px 10px;">#}
{#                        <ul class="nav nav-pills nav-stacked vertical-nav">#}
{#                            <li><a style="margin: auto;" class="selected" href="#section1">State-change Hooked API</a></li>#}
{#                            <li><a style="width:100px; margin: auto;" href="#section2">Def-use Chain</a></li>#}
{#                            <li><a style="width:70px; margin: auto;" href="#section3">Resource</a></li>#}
{#                        </ul>#}
{#                    </nav>#}
{#                    <div class="col-sm-10">#}
{#                        <div class="panel-section" id="section1">#}
{#                            <p><i class="fa fa-bullseye" aria-hidden="true"></i>&nbsp; Tagged State-change Hooked APIs and Parameters </p>#}
{#                            <img src="{% static 'image/7.PNG' %}" style="height: 400px;width: 1200px;">#}
{#                            <table id="APItable">#}
{#                                <tr>#}
{#                                    <th>Lib</th>#}
{#                                    <th>Proc</th>#}
{#                                    <th>File</th>#}
{#                                    <th>Reg</th>#}
{#                                    <th>Net</th>#}
{#                                </tr>#}
{#                                <tr>#}
{#                                    <td>LoadLibrary(lpFileName)#}
{#                                    </td>#}
{#                                    <td>CreateProcess(lpApplicationName, lpCommandLine)#}
{#                                    OpenProcess(dwProcessId)#}
{#                                    ExitProcess#}
{#                                    WinExec(lpCmdLin)#}
{#                                    CloseHandle#}
{#                                    CreateRemoteThread#}
{#                                    TerminateProcess#}
{#                                    TerminateThread#}
{#                                    CreateThread(lpThreadId)#}
{#                                    OpenThread(dwThreadId)#}
{#                                    </td>#}
{#                                    <td>CopyFile(lpExistingFileName)#}
{#                                    CreateFile(lpFileName)#}
{#                                    WriteFile(lpFileName)#}
{#                                    ReadFile#}
{#                                    DeleteFile(lpFileName)#}
{#                                    </td>#}
{#                                    <td>RegOpenKey(hKey)#}
{#                                    RegCloseKey(hKey)#}
{#                                    RegSetValue(hKey)#}
{#                                    RegCreateKey(hKey)#}
{#                                    RegDeleteKey(hKey)#}
{#                                    RegDeleteValue(hKey)#}
{#                                    </td>#}
{#                                    <td>WinHttpConnect(pwszServerName)#}
{#                                    WinHttpCreateUrl(pwszUrl)#}
{#                                    WinHttpOpen(pwszUserAgent)#}
{#                                    WinHttpOpenRequest(pwszObjectName)#}
{#                                    WinHttpReadData(lpBuffer)#}
{#                                    WinHttpSenRequest(lpOptional)#}
{#                                    WinHttpWriteData(lpBuffer)#}
{#                                    WinHttpGetProxyForUrl(lpcwszUrl)#}
{#                                    InternetOpen(lpszAgent)#}
{#                                    InternetConnect(lpszServerName)#}
{#                                    HttpSendRequest(lpOptional)#}
{#                                    GetUrlCacheEntryInfo(lpszUrlName)#}
{#                                    </td>#}
{#                                </tr>#}
{#                            </table>#}
{#                        </div>#}
                        <div class="panel-section hidden" id="section2">
                            <p><i class="fa fa-bullseye" aria-hidden="true"></i>&nbsp; The Def-use Chain </p>
                            <img src="{% static 'image/defchagraph.JPG' %}" style="width: 500px;">
                            <p style="padding-top: 20px"><i class="fa fa-bullseye" aria-hidden="true"></i>&nbsp; Explained</p>
{#                            <img src="{% static 'image/6.PNG' %}" style="height: 200px;">#}
                            <table>
                                <tr>
                                    <td class="actionAPI">CreateFile</td>
                                    <td>C:\Temp\n640\s640.exe, GENERIC_WRITE, CREATE_ALWAYS</td>
                                </tr>
                                <tr>
                                    <td class="actionAPI">RegQueryValue</td>
                                    <td>HKCU\Software\Microsoft\Windows\ShellNoRoam\MUICache\C:\Temp\n640\s640.exe</td>
                                </tr>
                                <tr>
                                    <td class="actionAPI">CreateFile</td>
                                    <td>C:\Temp\n640\s640.exe, GENERIC_READ, OPEN_EXISTING</td>
                                </tr>
                                <tr>
                                    <td class="actionAPI">RegSetValue</td>
                                    <td>HKCU\Software\Microsoft\Windows\ShellNoRoam\MUICache\C:\Temp\n640\s640.exe, data=install manager</td>
                                </tr>
                                <tr>
                                    <td class="actionAPI">CreateFile</td>
                                    <td>C:\Temp\n640\s640.exe, GENERIC_READ, OPEN_EXISTING</td>
                                </tr>
                                <tr>
                                    <td class="actionAPI">CreateProcess</td>
                                    <td>C:\Temp \n640\s640.exe ins.exe /e12051894, ProcessId=3272</td>
                                </tr>
                            </table>
                        </div>
                        <div class="panel-section hidden" id="section3">
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
{% block extra_js%}
<script>
    var myVar = document.getElementById("myVar").value;
    document.getElementById("hashFrame").src="/analysis/"+myVar;
</script>
<script>
function printFrame() {
    var print_frame = document.getElementById("hashFrame").contentWindow;
    print_frame.focus();// focus on contentWindow is needed on some ie versions
    print_frame.print();
}
</script>
<script>

    var body_height = $("body").innerHeight();
    $("#hashFrame").height(body_height-300);

    $(function () {

        var viewer = ImageViewer({
            zoomValue: 100,
            maxZoom: 1000
        });
        $('.gallery-items').click(function () {
            var imgSrc = this.src,
                highResolutionImage = $(this).data('high-res-img');

            viewer.show(imgSrc, highResolutionImage);
        });
        var viewer2 = ImageViewer({
            zoomValue: 500,
            maxZoom: 2000
        });
        $('.profile-picture').click(function () {
            var imgSrc = this.src,
                highResolutionImage = $(this).data('high-res-img');

            viewer2.show(imgSrc, highResolutionImage);
        });
    });

    $('.vertical-nav li a').click(function(li) {
        $('a').removeClass('selected');
        $(this).addClass('selected');

        $('.panel-section').addClass('hidden');
        var target = $(this).attr("href");
        $(target).removeClass('hidden');
    });

</script>
{% endblock %}
</html>

