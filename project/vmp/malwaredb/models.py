from django.db import models
from user_account.models import UserAccount


class Malware(models.Model):
    hash = models.CharField(max_length=64)
    firstseen = models.DateTimeField(blank=True, null=True)
    submissiondate = models.DateTimeField()
    detectionrate = models.DecimalField(max_digits=3, decimal_places=2)
    virustotalurl = models.CharField(max_length=200)
    vmp = models.CharField(max_length=64)
    md5 = models.CharField(max_length=100, blank=True, null=True)
    sha1 = models.CharField(max_length=100, blank=True, null=True)
    sha256 = models.CharField(max_length=100, blank=True, null=True)
    create_hooklog_state = models.BooleanField(default=False)

    def __str__(self):
        return self.vmp


class Upload(models.Model):
    name = models.CharField(max_length=64)
    size = models.BigIntegerField()
    hash = models.CharField(max_length=64)
    submissiondate = models.DateTimeField()
    user_ip = models.CharField(max_length=20, blank=True, null=True)
    user_account = models.ForeignKey(UserAccount, null=True)

    def __str__(self):
        return self.name


class VirusTotalInfo(models.Model):
    vendor = models.CharField(max_length=100)
    version = models.CharField(max_length=50, blank=True, null=True)
    detected = models.BooleanField()
    label = models.CharField(max_length=100, blank=True, null=True)
    update_date = models.DateField(blank=True, null=True)
    malware = models.ForeignKey(Malware)
    md5 = models.CharField(max_length=50)
