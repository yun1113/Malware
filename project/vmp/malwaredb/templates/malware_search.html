{% extends 'base.html' %}
{% load static %}

{% block extra_css%}
    <script type="text/javascript" src="{% static 'js/sorttable.js' %}"></script>
{% endblock %}

{% block body %}
    <div class="panel panel-default">
        <!-- Default panel contents -->
        <div class="panel-heading"><b>Search Result</b></div>

        {% if vendor_list %}
        <!-- Table -->
        <table class="table table-striped sortable">
            <tr>
                <th>AV Vendor</th>
                {% if keyword %}
                    <th>Detected</th>
                {% endif %}
                <th>AV Version</th>
                <th>Label</th>
                <th>VirusTotal Update Date</th>
                <th>MD5</th>
                <th colspan="2">API Profile</th>
            </tr>
            {% for vendor in vendor_list %}
            <tr>
                <td>{{ vendor.vendor }}</td>
                {% if keyword %}
                    <td>{{ vendor.detected }}</td>
                {% endif %}
                <td>{{ vendor.version }}</td>
                <td>{{ vendor.label }}</td>
                <td>{{ vendor.update_date }}</td>
                <td>{{ vendor.md5 }}</td>
                <td>
                    <a href="/malwaredetail/?malware={{ vendor.malware.hash }}"> View </a>
                </td>
                <td>
                    <a href="/malwaredownload/?malware={{ vendor.malware.hash }} " download="{{ vendor.malware.hash }}"> Download </a>
                </td>
            </tr>
            {% endfor %}
        </table>
        <span id='table_page'></span>
        {% else %}
            <div style="text-align: center;"><h4>Sorry, there is no result.</h4></div>
        {% endif %}
    </div>
{% endblock %}
