{% extends 'base.html' %}
{% load static %}

{% block body %}
    <!-- Title -->
    <div class="container-fluid">
      <div class="row">
        <div class="col-xs-12 col-md-12 page-header">
          <h1>We offer TWO free online services:</h1>
        </div>
      </div>
    </div>
    <!-- /Title -->

    <!-- service1 -->
    <a name="PROFILING"></a>
    <div class="container-fluid container-space" id="service1">
      <div class="row">
        <div class="col-md-6">
          <div class="row">
            <div class="col-md-10 col-xs-12 col-md-offset-1">
	          <h3><b><i class="fa fa-bullseye" aria-hidden="true"></i>&nbsp; HIGH LEVEL MALWARE PROFILING</b></h3>
	          <br>
	          <p>The system performs automated dynamic profiling of a malware or a suspicious binary file and produces a report of the time-ordered sequence of high-level API call invocations with parameters and return values. The report uncovers the behavior of the malware and provides in-depth and thorough information to increase the understanding of malware behavior and techniques used to engage harmful or malicious activities.</p>
	        </div>
            <div class="col-md-10 col-xs-12 col-md-offset-1 jumbotron" style="background: #fff5cc !important;padding: 0px;">
              <div class="col-xs-4 col-md-4" style="text-align: center;margin: 0px; font-size:18px;">
                <p><h2><b>{{ analysis_num }}</b></h2>Total analyses</p>
              </div>
              <div class="col-xs-4 col-md-4" style="text-align: center;margin: 0px; font-size:18px;">
                <p><h2><b>{{ upload_num }}</b></h2>Total submition</p>
              </div>
              <div class="col-xs-4 col-md-4" style="text-align: center;margin: 0px; font-size:18px;">
                <p><h2><b>{{ malware_num }}</b></h2>Unique Malware</p>
              </div>
            </div>
          </div>
        </div>
        <div class="col-md-6 ">
          <h3><i class="fa fa-upload" aria-hidden="true">&nbsp;Upload Malware Sample</i></h3>
          <form id="uploadform"class="col-md-11 col-xs-12" action="/index/" enctype="multipart/form-data" method="post">
            {% csrf_token %}
            {% for field in upload_form %}
              {% if field.label|lower == 'file' %}
              <!--             <label>Please upload the file</label> -->
                <div class="form-group">
                  <div class="input-group">
                    <input type="text" class="form-control" value="" id="uploadFile" placeholder="No file selected" disabled="disabled">
                    <label class="input-group-btn">
                      <span class="btn btn-default" style="border-radius:8px;" >
                        <i class="fa fa-folder-o fa-lg" aria-hidden="true"></i>&nbsp;
                        Browse&hellip; <input type="file" name="{{ field.html_name }}" id="{{ field.id_for_label }}" style="display: none;" multiple required>
                      </span>
                    </label>
                  </div>
                </div>
                {{ form.file.errors }}
              {% endif %}
            {% endfor %}
            <div class="form-center"><input class="upload btn btn-primary" type="submit" name='upload' value="Submit"></div>
          </form>

          <h3><i class="fa fa-search" aria-hidden="true">&nbsp;Search Malware Profile <a href="/malwaredetail/?malware=10a7780faaf8214e35406f51bbc70304c32881a3171fab3b020f9a90700204b0" style="font-size: 16px;">(View)</a></i> </h3>
          <form class="col-md-11 col-xs-12" name="search" action="/malwaredb/" enctype="multipart/form-data" method="get" onsubmit="return check()">
            <div class="form-group">
            <input class="search-method" type="radio" name="search-method" value="#hashSearchText" checked="checked"><label>&nbsp;By Hash: </label>
              <div class="input-group">
                <input type="text" name="MD5" id="hashSearchText" class="form-control search-input" value="1f2366c3955cf09b599a8a9233367cac" >
{#                  placeholder="Please enter the hash value...">#}
                <div class="input-group-btn">
                  <button type="button" class="btn btn-default dropdown-toggle-hash" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">MD5<span class="caret"></span></button>
                  <ul class="dropdown-menu dropdown-menu-right hashtext-dropdown">
                    <li><a>MD5</a></li>
                    <li><a>SHA1</a></li>
                    <li><a>SHA256</a></li>
                  </ul>
                </div>
              </div>
            </div>
            <div class="form-group">
              <input class="search-method" type="radio" name="search-method" value="#keywordSearchText"><label>&nbsp;By Keyword: </label>
              <input disabled type="text" name="keyword" id="keywordSearchText" class="form-control search-input" placeholder="Please enter the keyword...">
            </div>
{#            <label style="padding-bottom: 5px;">Example: You can search by MD5: "<a href="/malwaredetail/?malware=10a7780faaf8214e35406f51bbc70304c32881a3171fab3b020f9a90700204b0">1f2366c3955cf09b599a8a9233367cac</a>"</label>#}
            <div class="form-center"><input class="btn btn-primary" id="searchBtn" type="submit" value="Go"></div>
          </form>
        </div>
      </div>
      <!-- Modal -->
      {% if u %}
	  <div class="modal fade" id="uploaddialog">
	    <div class="modal-dialog">
	      <!-- Modal content-->
	      <div class="modal-content">
	        <div class="modal-header">
              {% if success %}
	            <h3 class="modal-title">Upload success!</h3>
              {% else %}
                <h3 class="modal-title">Upload fail!</h3>
              {% endif %}
	        </div>
	        <div class="modal-body">
              {% if success %}
	            <div class="alert alert-success" role="alert">
                    <h4><b>Upload Success!</b>&nbsp;Your submitted sample is received. We'll start to analyze it and shall get back to you as soon as it is done. You may come back later and check. Or you can leave your email, we'll send you a notification.</h4>
                </div>
	            <p></p>
	            <form role="form" action="javascript:;" method="post" id="login-form" autocomplete="off">
	              <div class="form-group">
	                  <label for="email">Email</label>
	                  <input type="email" name="email" id="email" class="form-control" placeholder="somebody@example.com">
	              </div>
	              <input type="submit" class="btn btn-default" value="Submit">
	            </form>
              {% else %}
                <div class="alert alert-warning" role="alert">
                    <h4><b>Upload Fail!</b>&nbsp;Your submitted sample (sha256: <p style="display: inline; word-wrap: break-word;">{{ u.hash }}</p>) has been analyzed. It API profile is as follows: <br><br>
                        <p style="text-align: center;">
                            <a href="/malwaredetail/?malware={{ u.hash }}">View&nbsp;</a>
                            <a href="/malwaredownload/?malware={{ u.hash }} " download="{{ u.hash }}">Download</a>
                        </p>
                    </h4>
                </div>
              {% endif %}
	        </div>
	        <div class="modal-footer">
	          <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
	        </div>
	      </div>
	    </div>
	  </div>
      {% endif %}
    </div>
    <!-- /service1 -->

    <!-- service2 -->
    <a name="ANALYSIS"></a>
    <div class="container-fluid container-space" id="service2">
      <div class="row">
        <div class="col-md-6">
          <div class="col-md-10 col-xs-12 col-md-offset-1">
	        <h3><b><i class="fa fa-bullseye" aria-hidden="true"></i>&nbsp; COMMON BEHAVIOR MOTIF ANALYSIS OF A MALWARE FAMILY</b></h3>
	        <br>
	        <p>The system takes a number of variant samples of a malware family and produces a report of identified common stages shared between variants as well as differentiated motifs of individual variants. The system conducts global sequence analysis and examines in detail the constitution of the activities performed by the variants of a malware family.</p>
	      </div>
        </div>
        <div class="col-md-6">
          <form class="col-md-11 col-xs-12" name="search" action="/malwaredb/" enctype="multipart/form-data" method="get" onsubmit="return check()">
            <div class="form-group">
              <input class="search-method" type="radio" name="search-method" value="#familySearchText"><label>&nbsp;By Family: </label>
              <input disabled type="text" name="family" id="familySearchText" class="form-control search-input">
            </div>
            <div class="form-group">
              <input class="search-method" type="radio" name="search-method" value="#behaviorgroupSearchText"><label>&nbsp;By Behavior Group: </label>
              <div class="input-group">
                <input disabled type="text" class="form-control search-input" name="behaviorgroup" id="behaviorgroupSearchText" placeholder="Please enter the behavior group...">
                <div class="input-group-btn">
                  <button type="button" class="btn btn-default dropdown-toggle dropdown-toggle-behavior" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Behavior Group <span class="caret"></span></button>
                  <ul class="dropdown-menu dropdown-menu-right behavior-dropdown">
                    <li><a>behavior1</a></li>
                    <li><a>behavior2</a></li>
                    <li><a>behavior3</a></li>
                  </ul>
                </div>
              </div>
            </div>
{#            <label style="padding-bottom: 5px;">Example: You can search by MD5: "<a href="/malwaredetail/?malware=10a7780faaf8214e35406f51bbc70304c32881a3171fab3b020f9a90700204b0">1f2366c3955cf09b599a8a9233367cac</a>"</label>#}
            <div class="form-center"><input class="btn btn-primary" id="searchBtn" type="submit" value="Go"></div>
          </form>
        </div>
      </div>
    </div>
    <!-- /service2 -->

{% endblock %}
{% block extra_js%}
    <script>
        function check(){
            if(document.search.hashSearchText.value=='' && document.search.behaviorgroupSearchText.value==''
                    && document.search.familySearchText.value=='' && document.search.keywordSearchText.value==''){
                alert('Please enter the search text!!');
                return false;
            }
        }
        document.getElementById("id_file").onchange = function () {
            document.getElementById("uploadFile").value = this.value;
        };
        $(window).load(function(){
            $('#uploaddialog').modal('show');
        });
        $('.hashtext-dropdown a').on('click', function(){
            $('.dropdown-toggle-hash').html($(this).html() + '<span class="caret"></span>');
            $('#hashSearchText').attr('name', $(this).html())
        });
{#        $('.behavior-dropdown a').on('click', function(){#}
{#            $('.dropdown-toggle-behavior').html($(this).html() + '<span class="caret"></span>');#}
{#            $('#behaviorgroupSearchText').attr('name', $(this).html())#}
{#        });#}
        $('.search-method').on('click', function(){
            $(".search-input").prop('disabled', true);
            $(".search-input").prop('value', "");

            $(this.value).prop('disabled', false);
            if(this.value=="#hashSearchText")
                $(this.value).prop('value', "1f2366c3955cf09b599a8a9233367cac");
            if(this.value=="#familySearchText")
                $(this.value).prop('value', "firseria");
            if(this.value=="#behaviorgroupSearchText")
                $(this.value).prop('value', "behavior");

        });
    </script>
{% endblock %}
