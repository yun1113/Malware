{% extends 'base.html' %}
{% load static %}

{% block body %}
     <!-- Title -->
    <div class="container-fluid">
      <div class="row">
        <div class="col-xs-12 col-md-12 page-header">
          <h1>We offer TWO free online services:</h1>
        </div>
      </div>
    </div>
    <!-- /Title -->

     <!-- service1 -->
    <div class="container-fluid container-space" id="service1">
      <div class="row">
        <div class="col-md-6">
          <div class="row">
            <div class="col-md-10 col-xs-12 col-md-offset-1">
	          <h3><b><i class="fa fa-bullseye" aria-hidden="true"></i>&nbsp; HIGH LEVEL MALWARE PROFILING</b></h3>
	          <br>
	          <p>The system performs automated dynamic profiling of a malware or a suspicious binary file and produces a report of the time-ordered sequence of high-level API call invocations with parameters and return values. The report uncovers the behavior of the malware and provides in-depth and thorough information to increase the understanding of malware behavior and techniques used to engage harmful or malicious activities.</p>
	          </div>
            <div class="col-md-10 col-xs-12 col-md-offset-1 jumbotron" style="background: #fff5cc !important;padding: 0px;">
              <div class="col-xs-4 col-md-4" style="text-align: center;margin: 0px;">
                <p><h2><b>123456</b></h2><br>Total analyses</p>
              </div>
              <div class="col-xs-4 col-md-4" style="text-align: center;margin: 0px;">
                <p><h2><b>654321</b></h2><br>Total submit</p>
              </div>
              <div class="col-xs-4 col-md-4" style="text-align: center;margin: 0px;">
                <p><h2><b>987456</b></h2><br>Unique Malware</p>
              </div>
            </div>
          </div>
        </div>
        <div class="col-md-6 ">
          <h3><i class="fa fa-upload" aria-hidden="true">&nbsp;Upload Malware</i></h3>
          <form class="col-md-11 col-xs-12" action="/malwareupload/" enctype="multipart/form-data" method="post">
            {% csrf_token %}
            {% for field in form %}
              {% if field.label|lower == 'file' %}
              <!--             <label>Please upload the file</label> -->
                <div class="form-group">
                  <div class="input-group">
                    <input type="text" class="form-control" value="" id="uploadFile" placeholder="No file selected" disabled="disabled">
                    <label class="input-group-btn">
                      <span class="btn btn-default" style="border-radius:8px;" >
                        <i class="fa fa-folder-o fa-lg" aria-hidden="true"></i>&nbsp;
                        Browse&hellip; <input type="file" name="photo" id="Upload photo" style="display: none;" multiple>
                      </span>
                    </label>
{#        label id="hintText" class="col-xs-12" for="uploadFile">Please upload the file</label>#}
{#        <input class="col-xs-9" type="text" id="uploadFile" placeholder="No file selected" disabled="disabled" />#}
{#        <input class="col-xs-3" id="{{ field.id_for_label }}" type="file" name="{{ field.html_name }}" required>#}
{#        <label class="col-xs-3" id="chooseFileLabel"for="{{ field.id_for_label }}">Choose files</label>#}
                  </div>
                </div>
                {{ form.file.errors }}
              {% endif %}
            {% endfor %}
            <input class="btn btn-primary" type="submit" value="Submit">
          </form>

          <h3><i class="fa fa-search" aria-hidden="true">&nbsp;Search Malware</i></h3>
          <form style="padding-top: 20px" class="col-md-11 col-xs-12" name="search" action="/malwaredb/" enctype="multipart/form-data" method="get" onsubmit="return check()">
            <div class="form-group">
            <label>By Hash: </label>
              <div class="input-group">
                <input type="text" name="hashSearchText" id="hashSearchText" class="form-control" placeholder="Please enter the hash value...">
                <div class="input-group-btn">
                  <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Hash <span class="caret"></span></button>
                  <ul class="dropdown-menu dropdown-menu-right">
                    <li><a href="#">MD5</a></li>
                    <li><a href="#">SHA1</a></li>
                    <li><a href="#">SHA256</a></li>
                  </ul>
                </div>
              </div>
            </div>
            <div class="form-group">
              <label>By Behavior Group: </label>
              <div class="input-group">
                <input type="text" class="form-control" name="behaviorgroupSearchText" id="behaviorgroupSearchText" placeholder="Please enter the behavior group...">
                <div class="input-group-btn">
                  <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Behavior Group <span class="caret"></span></button>
                  <ul class="dropdown-menu dropdown-menu-right">
                    <li><a href="#">behavior1</a></li>
                    <li><a href="#">behavior2</a></li>
                    <li><a href="#">behavior3</a></li>
                  </ul>
                </div>
              </div>
            </div>
            <div class="form-group">
              <label>By Keyword: </label>
              <input type="text" name="keywordSearchText" id="keywordSearchText" class="form-control" placeholder="Please enter the keyword...">
            </div>
            <input class="btn btn-primary" id="searchBtn" type="submit" value="Go">
          </form>
        </div>
      </div>
    </div>
    <!-- /service1 -->

    <!-- service2 -->
    <div class="container-fluid container-space" id="service2">
      <div class="row">
        <div class="col-md-6">
          <div class="col-md-10 col-xs-12 col-md-offset-1">
	        <h3><b><i class="fa fa-bullseye" aria-hidden="true"></i>&nbsp; COMMON BEHAVIOR MOTIF ANALYSIS OF A MALWARE FAMILY</b></h3>
	        <br>
	        <p>The system takes a number of variant samples of a malware family and produces a report of identified common stages shared between variants as well as differentiated motifs of individual variants. The system conducts global sequence analysis and examines in detail the constitution of the activities performed by the variants of a malware family.</p>
	      </div>
        </div>
        <div class="col-md-6">
        </div>
      </div>
    </div>
    <!-- /service2 -->



    {% if u %}
        <div class="UploadMessage">
            {% if success %}
                <div id="success" class="alert alert-success fade in">
                    <a href="#" class="close" data-dismiss="alert" aria-label="close">&times;</a>
                    <strong>Success!</strong> File {{u.name}} (size: {{u.size}} bytes) is uploaded. <br>
                        The hash is {{u.hash}}}. <br>
                </div>
            {% else %}
                <div id="error" class="alert alert-warning fade in">
                    <a href="#" class="close" data-dismiss="alert" aria-label="close">&times;</a>
                    <strong>Warning!</strong> File {{u.name}} (size: {{u.size}} bytes) has been uploaded. <br>
                        The hash is {{u.hash}}}. <br>
                </div>
            {% endif %}
        </div>
    {% endif %}

{% endblock %}
{% block extra_js%}
    <script>
        function check(){
            if(document.search.hashSearchText.value=='' && document.search.keywordSearchText.value==''){
                alert('Please enter the search text!!');
                return false;
            }
        }
        document.getElementById("id_file").onchange = function () {
            document.getElementById("uploadFile").value = this.value;
        };
    </script>
{% endblock %}
