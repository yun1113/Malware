{% extends 'base.html' %}
{% load static %}

{% block body %}
        <div class="container">
            <div style="position: relative; top: 20px;">
                <div class="row" style="height: 100%;">
                    <div class="col-md-6"  style="text-align: left;">
                        <p>We offer TWO free online services:</p>
                        <h1 style="font-size:25px;"><b>◎ HIGH LEVEL MALWARE PROFILING</b></h1>
                        <p>The system performs automated dynamic profiling of a malware or a suspicious binary file and produces a report of the time-ordered sequence of high-level API call invocations with parameters and return values. The report uncovers the behavior of the malware and provides in-depth and thorough information to increase the understanding of malware behavior and techniques used to engage harmful or malicious activities.</p>
                    </div>
                    <div id="upload" class="col-md-6" style="padding-top: 80px;">
                        <form action="/malwareupload/" enctype="multipart/form-data" method="post">
                            {% csrf_token %}
                            {% for field in form %}
                                {% if field.label|lower == 'file' %}
                                    <label for="{{ field.id_for_label }}">Choose files</label>
                                    <input type="text" id="uploadFile" placeholder="No file selected" disabled="disabled" />
                                    <input id="{{ field.id_for_label }}" type="file" name="{{ field.html_name }}" required>
                                    {{ form.file.errors }}
                                {% endif %}
                            {% endfor %}
                            <input class="btn btn-default" type="submit" value="Upload" />
                        </form>
                    </div>
                    <div id="search" class="col-md-6">
                        <form name="search" action="/malwaredb/" enctype="multipart/form-data" method="get" onsubmit="return check()">
                            <div class="row">
                                <div class="col-sm-12 search-column">
                                    <label class="col-xs-4" for="hashSearchText">By Hash</label>
                                    <select id="hashType" class="col-xs-2" name="hashType">
                                        <option value="md5">MD5</option>
                                        <option value="sh1">SHA1</option>
                                        <option value="sh1">SHA256</option>
                                    </select>
                                    <input class="col-xs-6" type="text" name="hashSearchText" id="hashSearchText" placeholder="Please enter the hash value..." />
                                </div>
                                <div class="col-sm-12 search-column">
                                    <label class="col-xs-4" for="behaviorgroupSearchText">By Behavior Group</label>
                                    <input class="col-xs-8" type="text" name="behaviorgroupSearchText" id="behaviorgroupSearchText" placeholder="Please enter the behavior group..." />
                                </div>
                                <div class="col-sm-12 search-column">
                                     <label class="col-xs-4" for="keywordSearchText">By Keyword</label>
                                    <input class="col-xs-8" type="text" name="keywordSearchText" id="keywordSearchText" placeholder="Please enter the keyword..." />
                                </div>
                                <div class="col-sm-12 search-column">
                                    <input class="btn btn-default" id="searchBtn" type="submit" value="Search"/>
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
            <div style="position: relative; top: 20px;">
                <div class="row" style="height: 100%;">
                    <div class="col-md-6" style="text-align: left;">
                        <h1 style="font-size:25px;"><b>◎ COMMON BEHAVIOR MOTIF ANALYSIS OF A MALWARE FAMILY</b></h1>
                        <p>The system takes a number of variant samples of a malware family and produces a report of identified common stages shared between variants as well as differentiated motifs of individual variants. The system conducts global sequence analysis and examines in detail the constitution of the activities performed by the variants of a malware family.</p>
                    </div>
                </div>
            </div>
        </div>
        {% if u %}
            <div class="UploadMessage">
                {% if success %}
                    <div id="success" class="alert alert-success fade in">
                        <a href="#" class="close" data-dismiss="alert" aria-label="close">&times;</a>
                        <strong>Success!</strong> File {{u.name}} (size: {{u.size}} bytes) is uploaded. <br>
                            The hash is {{u.hash}}}. <br>
                    </div>
                {% else %}
                    <div id="error" class="alert alert-warning fade in">
                        <a href="#" class="close" data-dismiss="alert" aria-label="close">&times;</a>
                        <strong>Warning!</strong> File {{u.name}} (size: {{u.size}} bytes) has been uploaded. <br>
                            The hash is {{u.hash}}}. <br>
                    </div>
                {% endif %}
            </div>
        {% endif %}
{% endblock %}
{% block extra_js%}
    <script>
        function check(){
            if(document.search.hashSearchText.value=='' && document.search.keywordSearchText.value==''){
                alert('Please enter the search text!!');
                return false;
            }
        }
        document.getElementById("id_file").onchange = function () {
            document.getElementById("uploadFile").value = this.value;
        };
    </script>
{% endblock %}
