{% extends 'base.html' %}
{% load static %}

{% block body %}
    <!-- Title -->
    <div class="container-fluid container-space">
      <div class="row">
        <div class="col-xs-12 col-md-12 ">
          <h1 style="text-align: left; font-size: 24px;">We offer TWO free online services:</h1>
        </div>
      </div>
    </div>
    <!-- /Title -->

    <!-- service1 -->
    <div class="container-fluid container-space" id="service1">
      <div class="row">
        <div class="col-md-6 col-xs-6">
          <h3><b><i class="fa fa-bullseye" aria-hidden="true"></i>&nbsp; HIGH_LEVEL MALWARE PROFILING</b></h3>
          <br>
          <p>The system performs automated dynamic profiling of a malware or a suspicious binary file and produces a report of the time-ordered sequence of high-level API call invocations with parameters and return values. The report uncovers the behavior of the malware and provides in-depth and thorough information to increase the understanding of malware behavior and techniques used to engage harmful or malicious activities.</p>
        </div>
        <div class="col-md-6  col-xs-6">
          <form class="col-md-10 col-xs-12 col-md-offset-1" action="/malwareupload/" enctype="multipart/form-data" method="post">
            {% csrf_token %}
            {% for field in form %}
              {% if field.label|lower == 'file' %}
{#                          <label id="hintText" class="col-xs-12" for="uploadFile">Please upload the file</label>#}
{#        <input class="col-xs-9" type="text" id="uploadFile" placeholder="No file selected" disabled="disabled" />#}
{#        <input class="col-xs-3" id="{{ field.id_for_label }}" type="file" name="{{ field.html_name }}" required>#}
{#        <label class="col-xs-3" id="chooseFileLabel"for="{{ field.id_for_label }}">Choose files</label>#}

                <div class="input-group">
                  <span class="input-group-addon"><i class="glyphicon glyphicon-open"></i></span>
                  <input type="text" class="form-control" value="" id="uploadFile" placeholder="No file selected" disabled="disabled">
                </div>
                <span id="fileselector">
                  <label class="btn btn-default" for="upload-file-selector">
                    <input id="upload-file-selector" type="file">
                    Upload file
                  </label>
            </span>
                {{ form.file.errors }}
              {% endif %}
            {% endfor %}
            <input class="btn btn-default" type="submit" value="Submit">
          </form>
          <form style="padding-top: 20px" class="col-md-10 col-xs-12 col-md-offset-1" name="search" action="/malwaredb/" enctype="multipart/form-data" method="get" onsubmit="return check()">
            <div class="input-group">
              <span class="input-group-addon"><i class="glyphicon glyphicon-search"></i></span>
                <select id="hashType" class="col-xs-2" name="hashType" style="padding: 5px 3px; background-color: white;">
                  <option value="md5">MD5</option>
                  <option value="sh1">SHA1</option>
                  <option value="sh1">SHA256</option>
                </select>
              <input type="text" class="form-control" name="hashSearchText" id="hashSearchText" placeholder="Please enter the hash value..." >
              <input type="text" class="form-control" name="behaviorgroupSearchText" id="behaviorgroupSearchText" placeholder="Please enter the behavior group...">
              <input type="text" class="form-control" name="keywordSearchText" id="keywordSearchText" placeholder="Please enter the keyword...">
            </div>
            <input class="btn btn-default" id="searchBtn" type="submit" value="Go">
          </form>
        </div>
      </div>
    </div>
    <!-- /service1 -->

    <!-- service2 -->
    <div class="container-fluid container-space" id="service2" style="margin-bottom: 50px">
      <div class="row">
        <div class="col-md-6  col-xs-6">
          <h3><b><i class="fa fa-bullseye" aria-hidden="true"></i>&nbsp; COMMON BEHAVIOR MOTIF ANALYSIS OF A MALWARE FAMILY</b></h3>
          <br>
          <p>The system takes a number of variant samples of a malware family and produces a report of identified common stages shared between variants as well as differentiated motifs of individual variants. The system conducts global sequence analysis and examines in detail the constitution of the activities performed by the variants of a malware family.</p>
        </div>
        <div class="col-md-6  col-xs-6">
        </div>
      </div>
    </div>
    <!-- /service2 -->
    {% if u %}
        <div class="UploadMessage">
            {% if success %}
                <div id="success" class="alert alert-success fade in">
                    <a href="#" class="close" data-dismiss="alert" aria-label="close">&times;</a>
                    <strong>Success!</strong> File {{u.name}} (size: {{u.size}} bytes) is uploaded. <br>
                        The hash is {{u.hash}}}. <br>
                </div>
            {% else %}
                <div id="error" class="alert alert-warning fade in">
                    <a href="#" class="close" data-dismiss="alert" aria-label="close">&times;</a>
                    <strong>Warning!</strong> File {{u.name}} (size: {{u.size}} bytes) has been uploaded. <br>
                        The hash is {{u.hash}}}. <br>
                </div>
            {% endif %}
        </div>
    {% endif %}

{% endblock %}
{% block extra_js%}
    <script>
        function check(){
            if(document.search.hashSearchText.value=='' && document.search.keywordSearchText.value==''){
                alert('Please enter the search text!!');
                return false;
            }
        }
        document.getElementById("id_file").onchange = function () {
            document.getElementById("uploadFile").value = this.value;
        };
    </script>
{% endblock %}
