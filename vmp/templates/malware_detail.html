{% extends 'base.html' %}
{% load static %}

{% block body %}

<div class="container-fluid malware_info">
    <ul class="nav nav-tabs">
        <li class="active"><a data-toggle="tab" href="#home"><b>Sample Information</b></a></li>
        <li>
            <a data-toggle="tab" href="#menu2"><b>Behavior Analysis</b></a>
        </li>
        <li>
            <a data-toggle="tab" href="#menu3"><b>Virus Total Information</b></a>
        </li>
    </ul>

    <div class="tab-content">
        <div id="home" class="tab-pane fade in active">
            <ul class="list-group">
                <input type="hidden" id="myVar" name="variable" value="{{malware.hash}}">
                <li class="list-group-item"><b>Hash: </b>{{malware.hash}}</li>
                <li class="list-group-item"><b>Submission Date: </b>{{malware.submissiondate}}</li>
                <li class="list-group-item"><b>Firstseen (VirusTotal): </b>{{malware.firstseen}}</li>
                <li class="list-group-item"><b>VirusTotal Detection Rate: </b>{{malware.detectionrate}}</li>
                <li class="list-group-item"><b>VirusTotal Url: </b>{{malware.virustotalurl}}</li>
            </ul>
        </div>
        <div id="menu2" class="tab-pane fade">
            <div class="share">
                <div class="col-md-12 col-xs-12 jumbotron" style="background: #fff5cc !important; padding: 0px; margin-bottom: 10px;">
                  <p>This sample create total {{ hooklog_list|length }} profile.</p>
                  <pre>#"timestamp" "API_ame" <br>"a list of parameters and return value"</pre>
                </div>
                {% if hooklog_list %}
                    <a id="save_link" style="text-decoration: none;" href="/malwaredownload/{{ malware.hash }}/{{ page }}" download="{{ malware.hash }}">
                        <img id="save_img" src="{% static 'image/save.png' %}">
                    </a>
                    <img style="cursor: pointer;" id="print_img" src="{% static 'image/print.png' %}" onClick="printFrame()">
                    {% for log in hooklog_list %}
                        <a style="cursor: pointer;" class="hooklog-page">{{ forloop.counter }}</a>
                    {% endfor %}
                {% endif %}
            </div>
            {% if hooklog_list %}
                <iframe id="hashFrame" src=''  scrolling="yes"></iframe>
            {% endif %}
        </div>
        <div id="menu3" class="tab-pane fade">
            <div class="share">
            {% if vendor_list %}
            <!-- Table -->
            <table class="table table-striped sortable">
                <tr>
                    <th>AV Vendor</th>
                    {% if keyword %}
                        <th>Detected</th>
                    {% endif %}
                    <th>AV Version</th>
                    <th>Label</th>
                    <th>VirusTotal Update Date</th>
                </tr>
                {% for vendor in vendor_list %}
                <tr>
                    <td>{{ vendor.vendor }}</td>
                    {% if keyword %}
                        <td>{{ vendor.detected }}</td>
                    {% endif %}
                    <td>{{ vendor.version }}</td>
                    <td>{{ vendor.label }}</td>
                    <td>{{ vendor.update_date }}</td>
                </tr>
                {% endfor %}
            </table>
            <span id='table_page'></span>
            {% else %}
                <div style="text-align: center;"><h4>Sorry, there is no result.</h4></div>
            {% endif %}
            </div>
        </div>
    </div>
</div>
{% endblock %}
{% block extra_js%}
<script>
    var myVar = document.getElementById("myVar").value;
    document.getElementById("hashFrame").src="/analysis/"+myVar+"/1";
</script>
<script>
function printFrame() {
    var print_frame = document.getElementById("hashFrame").contentWindow;
    print_frame.focus();// focus on contentWindow is needed on some ie versions
    print_frame.print();
}
</script>
<script>
    $('.hooklog-page').click(function(){
        document.getElementById("hashFrame").src="/analysis/"+myVar+"/"+ $(this).text();
        document.getElementById("save_link").href="/malwaredownload/"+myVar+"/"+ $(this).text();
    });
</script>
<script>
    var body_height = $("body").innerHeight();
{#    $("#hashFrame").height(body_height-300);#}
</script>
{% endblock %}
</html>


